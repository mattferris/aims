#!/usr/bin/perl
#
# This file is part of aims, an iptables scripting language.
#
#

use strict;
use warnings;

use Aims::Main qw(compile getcompiled);
use Aims::Base;
use Aims::Filter;
use Aims::NAT;

if (!defined($ARGV[0])) {
    die("usage: aims { check | help | show } [ options ]\n");
}

my $cmd = $ARGV[0];

if ($cmd eq 'show') {
    if (@ARGV < 2) {
        die("usage: aims show file\n");
    }

    compile($ARGV[1]);
    my $out = getcompiled();

    foreach my $l (@$out) {
        print $l."\n";
    }
}
elsif ($cmd eq 'check') {
    if (@ARGV < 2) {
        die("usage: aims check file\n");
    }

    compile($ARGV[1]);
}
elsif ($cmd eq 'help') {
    print "
aims { help | show } [ options ]

    check   Check the file for errors and/or warnings
    help    Display this message
    show    Display the generated iptables commands

";
}
else {
    die("unknown command: $ARGV[0]\n");
}
